---
title: SVM(支持向量机)
layout: post
share: false
---

# 1.预备知识

### 1.1 $KKT$ 条件

#### 无约束优化
对于变量 $x\in\mathbb{R}^n$ 的函数 $f(x)$ ,无约束优化问题如下:

$$\min_xf(x)$$

直接找到使目标函数导数为 $0$ 的点即可，即 $f'(x)=0$ ,如果没有解析解可以使用梯度下降或牛顿法等通过迭代使 $x$ 沿负梯度方向逐渐逼近最小值点。

##### 等式约束

如下等式约束问题：

$$\begin{aligned}
&\min_xf(x)  \\  
&s.t.~~~~h_i(x) = 0 , i = 1,2,...,m \\ 
\end{aligned}$$

约束条件会将解的范围限定在一个可行区域，此时不一定能找到 $f'(x)$ 为 $0$ 的点，只需找到可行区域内使得 $f(x)$ 最小的点即可，一般使用拉格朗日乘子法来进行求解，引入拉格朗日乘子 $\alpha\in\mathbb{R}^m$ ,构建拉格朗日函数：

$$L(x,\alpha)=f(x)+\sum_{i=1}^m\alpha_ih_i(x)$$

并分别对 $\alpha$ 和 $x$ 求偏导：

$$\left 
\{ 
\begin{aligned}  
\frac{\partial L(x,\alpha)}{\partial x}= 0  \\ 
\frac{\partial L(x,\alpha)}{\partial \alpha}= 0 
\end{aligned} 
\right.$$

求得 $x$ 、 $\alpha$ 的值，将 $x$ 代入 $f(x)$ 即为在约束条件 $h_i(x)$ 下的可行解。下面用一个示例来进行说明，对于二维的目标函数 $f(x,y)$ ,在平面中画出   $f(x,y)$ 的等高线，如下图虚线，并给出一个约束等式 $h(x,y)=0$ ,如下图绿线，目标函数 $f(x,y)$ 与约束 $g(x,y)$ 只可能相交，相切或没交集，只有相交或相切时才有可能是解，而且只有相切才可能得到可行解，因为相交意味着肯定还存在其它的等高线在该条等高线的内部或者外部，使得新的等高线与目标函数的交点的值更大或者更小。

![](https://darknessbeforedawn.github.io/test-book/images/SVM1.png)

因此,拉格朗日乘子法取得极值的必要条件是目标函数与约束函数相切，这时两者的法向量是平行的，即

$$f'(x)-\alpha h'(x)=0$$

所以只要满足上述等式，且满足约束 $h_i(x) = 0 , i = 1,2,…,m$ 即可得到解，联立起来，正好得到就是拉格朗日乘子法。以上为拉格朗日乘子法的几何推导。

##### 不等式约束

给定如下不等式约束问题：

$$\begin{aligned}
&\min_xf(x)  \\  
&s.t.~~~~g(x) \leq 0 , i = 1,2,...,m \\ 
\end{aligned}$$

对应的拉格朗日函数：

$$
L(x,\lambda) = f(x)+\lambda g(x)
$$

这时的可行解必须落在约束区域 $g(x)$ 之内，稀土给出了目标函数的等高线与约束：

![](https://darknessbeforedawn.github.io/test-book/images/SVM2.png)

由图可知可行解 $x$ 只能在 $g(x) \leq 0$的区域里:

(1)当可行解 $x$ 落在 $g(x)<0$ 的区域内，此时直接极小化 $f(x)$ 即可；

(2)当可行解 $x$ 落在 $g(x)=0$ 即边界上，此时等价于等式约束问题。

当约束区域包含目标函数原有的可行解时，此时加上约束可行解仍然落在约束区域内部，对应 $g(x)<0$ 的情况，这时约束条件不起作用；当约束区域不包含目标函数原有的可行解时，此时加上约束后可行解落在边界 $g(x)=0$ 上。下图分别描述了两种情况，右图表示加上约束可行解会落在约束区域的边界上。

![](https://darknessbeforedawn.github.io/test-book/images/SVM3.png)

以上两种情况，要么可行解落在约束边界上即得 $g(x)=0$ ，要么可行解落在约束区域内部，此时约束不起作用，令 $\lambda = 0$ 消去约束即可，所以无论哪种情况都会得到：

$$\lambda g(x)=0$$

在等式约束优化中，约束函数与目标函数的梯度只要满足平行即可，而在不等式约束中则不然，若 $\lambda \neq 0$，则可行解 $x$ 是落在约束区域的边界上，这时可行解应尽量靠近无约束时的解，所以在约束边界上，目标函数的负梯度方向应该远离约束区域朝向无约束时的解，此时正好可得约束函数的梯度方向与目标函数的负梯度方向应相同：

$$-\nabla_xf(x)=\lambda\nabla_xg(x)$$

上式需要满足 $\lambda > 0$ ，这个问题可以举一个形象的例子，假设你去爬山，目标是山顶，但有一个障碍挡住了通向山顶的路，所以只能沿着障碍爬到尽可能靠近山顶的位置，然后望着山顶叹叹气，这里山顶便是目标函数的可行解，障碍便是约束函数的边界，此时的梯度方向一定是指向山顶的，与障碍的梯度同向，下图描述了这种情况:

![](https://darknessbeforedawn.github.io/test-book/images/SVM4.png)

对于不等式约束，只要满足一定的条件，依然可以使用拉格朗日乘子法解决，这里的条件便是 $KKT$ 条件。

对于以下约束问题:

$$\begin{aligned}
&\min_xf(x)  \\  
&s.t.~~~~h_i(x)=0,i = 1,2,...,m \\
&~~~~~~~~~~g(x) \leq 0 , j = 1,2,...,n \\ 
\end{aligned}$$

对应拉格朗日函数：

$$L(x,\alpha,\beta)=f(x)+\sum_{i=1}^m\alpha_ih_i(x)+\sum_{j=1}^n\beta_ig_i(x)$$

则不等式约束后的可行解 $x$ 需要满足的 $KKT$ 条件为：

$$\begin{align}
\nabla_x L(x,\alpha,\beta) &= 0   \\ 
\beta_jg_j(x) &= 0  , \ j=1,2,...,n\\ 
h_i(x)&= 0 , \ i=1,2,...,m  \\ 
g_j(x) &\le 0  , \  j=1,2,...,n  \\ 
\beta_j &\ge  0 , \ j=1,2,...,n  \\ 
\end{align} $$

满足 $KKT$ 条件后极小化拉格朗日函数即可得到在不等式约束条件下的可行解。 $KKT$ 条件:

(1) ：拉格朗日取得可行解的必要条件；

(2) ：这就是以上分析的一个比较有意思的约束，称作松弛互补条件；

(3)(4) ：初始的约束条件；

(5) ：不等式约束的 Lagrange Multiplier 需满足的条件。

主要的 $KKT$ 条件便是 (3) 和 (5) ，只要满足这俩个条件便可直接用拉格朗日乘子法， $SVM$ 中的支持向量便是来自于此，需要注意的是 KKT 条件与对偶问题也有很大的联系。