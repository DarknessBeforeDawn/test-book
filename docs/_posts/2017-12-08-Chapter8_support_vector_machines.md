---
title: SVM(支持向量机)
layout: post
share: false
---

# 1.预备知识

### 1.1 KKT条件

#### 无约束优化
对于变量 $x\in\mathbb{R}^n$ 的函数 $f(x)$ ,无约束优化问题如下:

$$\min_xf(x)$$

直接找到使目标函数导数为 $0$ 的点即可，即 $f'(x)=0$ ,如果没有解析解可以使用梯度下降或牛顿法等通过迭代使 $x$ 沿负梯度方向逐渐逼近最小值点。

##### 等式约束

如下等式约束问题：

$$\begin{aligned}
&\min_xf(x)  \\  
&s.t.~~~~h_i(x) = 0 , i = 1,2,...,m \\ 
\end{aligned}$$

约束条件会将解的范围限定在一个可行区域，此时不一定能找到 $f'(x)$ 为 $0$ 的点，只需找到可行区域内使得 $f(x)$ 最小的点即可，一般使用拉格朗日乘子法来进行求解，引入拉格朗日乘子 $\alpha\in\mathbb{R}^m$ ,构建拉格朗日函数：

$$L(x,\alpha)=f(x)+\sum_{i=1}^m\alpha_ih_i(x)$$

并分别对 $\alpha$ 和 $x$ 求偏导：

$$\left 
\{ 
\begin{aligned}  
\frac{\partial L(x,\alpha)}{\partial x}= 0  \\ 
\frac{\partial L(x,\alpha)}{\partial \alpha}= 0 
\end{aligned} 
\right.$$

求得 $x$ 、 $\alpha$ 的值，将 $x$ 代入 $f(x)$ 即为在约束条件 $h_i(x)$ 下的可行解。下面用一个示例来进行说明，对于二维的目标函数 $f(x,y)$ ,在平面中画出   $f(x,y)$ 的等高线，如下图虚线，并给出一个约束等式 $h(x,y)=0$ ,如下图绿线，目标函数 $f(x,y)$ 与约束 $g(x,y)$ 只可能相交，相切或没交集，只有相交或相切时才有可能是解，而且只有相切才可能得到可行解，因为相交意味着肯定还存在其它的等高线在该条等高线的内部或者外部，使得新的等高线与目标函数的交点的值更大或者更小。

![](https://darknessbeforedawn.github.io/test-book/images/SVM1.png)

因此,拉格朗日乘子法取得极值的必要条件是目标函数与约束函数相切，这时两者的法向量是平行的，即

$$f'(x)-\alpha h'(x)=0$$

所以只要满足上述等式，且满足约束 $h_i(x) = 0 , i = 1,2,…,m$ 即可得到解，联立起来，正好得到就是拉格朗日乘子法。以上为拉格朗日乘子法的几何推导。

##### 不等式约束